(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2874],{11723:(e,t,a)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/apps/[app_id]/embedded-wallets",function(){return a(14969)}])},14969:(e,t,a)=>{"use strict";a.r(t),a.d(t,{__N_SSP:()=>es,default:()=>ec});var r=a(31085),n=a(13368),i=a.n(n),d=a(19684),o=a(14041),l=a(93454),s=a(15818),c=a(38293),p=a(36073),y=a(85451),_=a(92445),u=a(65749);let w=(e,t)=>{throw null!=t?t:Error("Expected never, got: ".concat(e))};var v=a(1048).Buffer;function h(e){let{message:t,privateKey:a,chainType:r}=e;return"bitcoin-segwit"===r?u.secp256k1.sign(v.from(t),a).toDERRawBytes():"bitcoin-taproot"===r?u.ko.sign(v.from(t),a):w(r)}async function I(e){let{appId:t,appClientId:a,accessToken:r,hdWalletIndex:n,chainType:i,entropy:d}=e,o=(0,_.E)({entropy:d,index:n,pathType:"bitcoin-taproot"===i?"taproot":"segwit"}),l=await (0,y.QQ)({appId:t,appClientId:a,accessToken:r,address:o.address,chainType:i}),s=function(e){let{domain:t,publicKeyHex:a,address:r,uri:n,nonce:i,issuedAt:d}=e;return"".concat(t," wants you to sign in with your Bitcoin account:\n").concat(a,"\n\nYou are proving you own ").concat(r,".\n\nURI: ").concat(n,"\nVersion: 1\nNonce: ").concat(i,"\nIssued At: ").concat(null!=d?d:new Date().toISOString(),"\nChain ID: ").concat("000000000019d6689c085ae165831e934ff763ae46a2a6c172b3f1b60a8ce26f","\nResources:\n- https://privy.io")}({domain:window.location.host,publicKeyHex:(0,c.My)(o.publicKey),uri:window.location.origin,address:o.address,nonce:l}),u=h({message:s,privateKey:o.privateKey,chainType:i});return await (0,y.Zn)({appId:t,appClientId:a,accessToken:r,data:{message:s,signature:p.K3.encode(u),chain_type:i,hd_node_index:n}})}var f=a(82926),m=a.n(f),g=a(39535),A=a(28192),T=a(1048).Buffer;async function E(e){let{appId:t,appClientId:a,accessToken:r,hdWalletIndex:n,entropy:i}=e;if(n<=0)throw new A.Pi("invalid_request_arguments","Failed to create additional wallet: invalid wallet index");let d=(0,g.kG)({entropy:i,index:n}),o=d.publicKey.toBase58(),l=await y.QQ({appId:t,appClientId:a,accessToken:r,address:o,chainType:"solana"}),s=(0,g.zT)(window.location.host,window.location.origin,o,l),c=m().sign.detached(T.from(s),d.secretKey);return await y.Zn({appId:t,appClientId:a,accessToken:r,data:{message:s,signature:p.K3.encode(c),hd_node_index:n,chain_type:"solana"}}),{keypair:d,address:o}}var P=a(78871),N=a(16830);let D=p.K3.decode(N.A.DELEGATED_ACTIONS_TEE_PUBLIC_KEY||""),b=async e=>{let{entropy:t,delegatedWallets:a,appId:r,appClientId:n,accessToken:i}=e,[d,o]=await (0,g.uY)(t);if("string"!=typeof N.A.DELEGATED_ACTIONS_TEE_PUBLIC_KEY)throw new A.Pi("error","Cannot delegate wallet actions - NEXT_PUBLIC_DELEGATED_ACTIONS_TEE_PUBLIC_KEY is not set.");let l=(0,P.Lv)(D,p.K3.encode(o));await (0,y.IW)({appId:r,appClientId:n,accessToken:i,data:{app_share:p.K3.encode(d),encrypted_tee_share:l,delegated_addresses:a.map(e=>{let{address:t,chainType:a,walletIndex:r}=e;return{address:t,chain_type:a,wallet_index:r}})}})};var O=a(34217);async function S(e){let t=(0,g.eB)({entropy:e,opts:{path:"m/3457'/10'/1'/0/".concat(0)}}).getHdKey().privateKey;return{publicKey:await (0,O.Rn)(t),privateKey:t}}async function C(e){let{appId:t,appClientId:a,entropy:r,accessToken:n}=e,{publicKey:i}=await S(r);return await y.aV({appId:t,appClientId:a,signerPublicKey:"0x".concat(O.jn.bytesToHex(i)),auth:{accessToken:n,mfaToken:null}})}var x=a(64942),R=a(46195),M=a(1048).Buffer;let K=R.z.string().regex(/^[A-Za-z0-9+/]*={0,2}\.[A-Za-z0-9+/]*={0,2}$/,{message:"Must be two base64 strings separated by a single period"});var L=a(55345);async function k(e,t){let{privateKey:a,chainType:r}=e;switch(t.method){case"sign":return{method:t.method,data:{signature:p.K3.encode(h({privateKey:a,message:t.params.message,chainType:r}))}};case"signTransaction":return{method:t.method,data:{signedTransaction:function(e){let{txAsPSBTHexString:t,privateKey:a}=e,r=L.ZX.fromPSBT((0,c.aT)(t),{allowLegacyWitnessUtxo:!0});return r.sign(a),r.finalize(),r.hex}({txAsPSBTHexString:t.params.psbt,privateKey:a})}}}}var V=a(17890),U=a(40049);async function W(e,t){if("ethereum"===t.chainType&&"ethereum"===e.chainType)return await (0,V.A)(e,t.request);if("solana"===t.chainType&&"solana"===e.chainType)return await (0,U.A)(e.wallet.keypair,{...t,publicKey:t.entropyId,signingPublicKey:e.wallet.address});if("bitcoin-segwit"===t.chainType&&"bitcoin-segwit"===e.chainType||"bitcoin-taproot"===t.chainType&&"bitcoin-taproot"===e.chainType)return await k({privateKey:e.wallet.privateKey,chainType:t.chainType},t.request);throw new A.Pi("invalid_request_arguments","Unknown chain type")}var q=a(62729);async function G(e){let{appId:t,userId:a,address:r}=e;if(!(0,g.qi)(r)&&!(0,g.Zf)(r))throw new A.Pi("invalid_request_arguments","Failed to initialize wallet: missing or invalid wallet address");if(!q.A.get({appId:t,userId:a,address:r}))throw new A.Pi("wallet_not_on_device","Failed to initialize wallet: wallet with address '".concat(r,"' not loaded on this device"))}var B=a(10280);let z={ethereum:{createFromPrivateKey:g.Bt,createSiwxMessage:g.t5},solana:{createFromPrivateKey:g.UI,createSiwxMessage:g.zT}};async function Y(e){let{appId:t,appClientId:a,userId:r,accessToken:n,privateKey:i,chainType:d}=e,{createFromPrivateKey:o,createSiwxMessage:l}=z[d],s=await o(i),{deviceShares:c,recoveryShares:_,wallet:u,entropy:w,signMessage:v}=s,h="address"in s?s.address:s.wallet.address,[I,f]=c,[m,A]=_,[T,{encryptionKey:E,walletRecoveryOutput:P}]=await Promise.all([y.QQ({appId:t,appClientId:a,accessToken:n,address:h,chainType:d}),(0,B.cq)({recoveryType:"privy_generated_recovery_key"})]),[N,D]=await Promise.all([(0,g.EN)(E),(0,g.vb)(m,E)]),b=l(window.location.host,window.location.origin,h,T),O=await v({message:b}),S=(0,g.hE)(),{recovery_key:C}=await (0,B.qz)(P);return await y.gc({appId:t,appClientId:a,accessToken:n,data:{chain_type:d,message:b,signature:O,device_id:S,device_auth_share:p.K3.encode(f),recovery_auth_share:p.K3.encode(A),encrypted_recovery_share:p.K3.encode(D.encryptedShare),encrypted_recovery_share_iv:p.K3.encode(D.encryptedShareIV),recovery_type:"privy_generated_recovery_key",recovery_key_hash:p.K3.encode(N),recovery_key:C,imported:!0}}),q.A.set({appId:t,userId:r,address:h},{share:p.K3.encode(I),deviceId:S}),{chainType:d,entropyType:"private-key",wallet:u,entropy:w,walletIndex:void 0}}var F=a(28933);async function J(e){var t;let{appId:a,appClientId:r,accessToken:n,mfaCode:i,mfaMethod:d,userId:o,relyingParty:l}=e;if(i&&d)try{let e=await y.j2({appId:a,appClientId:r,accessToken:n,method:d,code:i,relyingParty:l});return F.A.set({appId:a,userId:o},e),e.token}catch(e){throw F.A.del({appId:a,userId:o}),new A.Pi("missing_or_invalid_mfa","MFA verification failed")}return(null===(t=F.A.get({appId:a,userId:o}))||void 0===t?void 0:t.token)||(F.A.del({appId:a,userId:o}),null)}async function H(e){let{mfaCode:t,mfaMethod:a,...r}=e,n=await J({appId:r.appId,appClientId:r.appClientId,accessToken:r.accessToken,mfaCode:t,mfaMethod:a,userId:r.userId,relyingParty:r.relyingParty});switch(r.method){case"sms":return await y.St({appId:r.appId,appClientId:r.appClientId,accessToken:r.accessToken,phoneNumber:r.phoneNumber,mfaToken:n});case"totp":return await y.O({appId:r.appId,appClientId:r.appClientId,accessToken:r.accessToken,mfaToken:n});default:throw Error("Unknown mfa method")}}var j=a(44637);async function X(e){switch(e.method){case"sms":return await y._o({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,code:e.code,phoneNumber:e.phoneNumber});case"totp":return await y.q$({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,code:e.code});case"passkey":let t=await J({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,mfaCode:null,mfaMethod:null,relyingParty:"",userId:e.userId});await y.NB({appId:e.appId,appClientId:e.appClientId,accessToken:e.accessToken,credentialIds:e.credentialIds,mfaToken:t}),0===e.credentialIds.length&&F.A.del({appId:e.appId,userId:e.userId});return;default:throw Error("Unknown mfa method")}}function $(e){if("hd-entropy"!==e.entropyType)throw new A.Pi("hd_wallet_required","This action requires a hierarchical deterministic wallet. Imported wallets are not supported.")}async function Q(e){let{appId:t,appClientId:a,userId:r,accessToken:n,method:i,mfaCode:d,mfaMethod:o,relyingParty:l}=e,s=await J({appId:t,appClientId:a,accessToken:n,mfaCode:d,mfaMethod:o,userId:r,relyingParty:l}),c=await Z({appId:t,appClientId:a,accessToken:n,method:i,mfaToken:s});return F.A.del({appId:t,userId:r}),c}async function Z(e){let{appId:t,appClientId:a,accessToken:r,method:n,mfaToken:i}=e;switch(n){case"sms":return await y.jE({appId:t,appClientId:a,accessToken:r,mfaToken:i});case"totp":return await y.hH({appId:t,appClientId:a,accessToken:r,mfaToken:i});default:throw Error("Unknown mfa method")}}var ee=a(91162);function et(e){let{allowedOrigins:t,url:a}=e,r=new URL(a);if(0===t.length||t.some(e=>"*"===e.trim()))return!0;for(let e of t)if(r.origin===e||(function(e){let t=e.replace(/\./g,"\\.").replace(/\*/g,"[^.]*");return new RegExp("^".concat(t,"$"))})(e).test(r.origin))return!0;return!1}function ea(e){let{ReactNativeWebView:t}=e;return!!(t&&navigator.userAgent.includes("Android"))}function er(e){let{PRIVY_NATIVE_IOS:t,PRIVY_NATIVE_ANDROID:a,PRIVY_UNITY:r,ReactNativeWebView:n}=e;return a?"native-android":t?"native-ios":r?"unity":ea(e)?"expo-android":n?"expo-ios":"web"}let en={"privy:wallet:create":"embedded_wallet_iframe_create","privy:wallet:create-additional":"embedded_wallet_iframe_create_additional","privy:wallet:import":"embedded_wallet_iframe_import","privy:wallet:set-recovery-password":"embedded_wallet_iframe_set_recovery_password","privy:wallet:set-recovery":"embedded_wallet_iframe_set_recovery","privy:wallet:recover":"embedded_wallet_iframe_recover","privy:wallet:rpc":"embedded_wallet_iframe_rpc","privy:solana-wallet:create":"embedded_solana_wallet_iframe_create","privy:solana-wallet:create-additional":"embedded_solana_wallet_iframe_create_additional","privy:solana-wallet:recover":"embedded_wallet_iframe_solana_recover","privy:solana-wallet:rpc":"embedded_solana_wallet_iframe_rpc","privy:farcaster:init-signer":"embedded_wallet_iframe_farcaster_signer_init","privy:farcaster:sign":"embedded_wallet_iframe_farcaster_sign","privy:delegated-actions:consent":"embedded_wallet_iframe_delegated_actions_consent","privy:wallets:create":"embedded_wallet_iframe_create","privy:wallets:add":"embedded_wallet_iframe_create_additional","privy:wallets:import":"embedded_wallet_iframe_import","privy:wallets:set-recovery":"embedded_wallet_iframe_set_recovery","privy:wallets:connect":"embedded_wallet_iframe_connect","privy:wallets:recover":"embedded_wallet_iframe_recover","privy:wallets:rpc":"embedded_wallet_iframe_rpc"};function ei(e,t){var a,r,n,i,d;if(window.PRIVY_NATIVE_IOS)try{return null===(a=window.webkit)||void 0===a?void 0:a.messageHandlers.iOSProxy.postMessage(JSON.stringify(e))}catch(e){}if(window.PRIVY_NATIVE_ANDROID)try{return null===(r=window.AndroidProxy)||void 0===r?void 0:r.postMessage(JSON.stringify(e))}catch(e){}if(window.PRIVY_UNITY)try{return null===(n=window.UnityProxy)||void 0===n?void 0:n.postMessage(JSON.stringify(e))}catch(e){}if(window.ReactNativeWebView)try{return null===(d=window.ReactNativeWebView)||void 0===d?void 0:null===(i=d.postMessage)||void 0===i?void 0:i.call(d,JSON.stringify(e))}catch(e){}setTimeout(()=>{window.parent&&window.parent.postMessage(e,t)},0)}function ed(e,t,a,r){ei({id:t,event:a,data:r},e.origin)}function eo(e,t,a,r){ei({id:t,event:a,error:{type:(0,A.xR)(r)?r.type:A.z6,message:r.message}},e.origin)}function el(e){let t=(0,o.useRef)(null);function a(e,a,r){F.A.get({appId:e,userId:a})?t.current=null:t.current=r}return(0,o.useEffect)(()=>{var e;let t=window.location.href.startsWith("http://localhost"),a=[...null!==(e=location.ancestorOrigins)&&void 0!==e?e:[]].some(e=>e.startsWith("http://localhost"));t||a||(console.log("%cWarning!","color:#F16552; font-size:50px; font-weight: bold; -webkit-text-stroke: 1px black;"),console.log("%cYou are reading this message because you opened the browser console, a developer tool. Do not enter or paste code you do not understand. Never share your tokens or any other info with anyone. If someone told you to do this, it is very likely a scam.","font-size: 18px;"))},[]),(0,o.useEffect)(()=>{let r=e.appId,n=e.appClientId,i=(0,ee.q)(r,e.apiUrl);async function o(r){var o,c,p,_,u,v,h,f;if(!r)return;let m="string"==typeof r.data?JSON.parse(r.data):r.data;if(!("string"==typeof m.event&&/^privy:.+/.test(m.event))||(h=e.allowedDomains,!(window.PRIVY_NATIVE_IOS||window.PRIVY_NATIVE_ANDROID||window.PRIVY_UNITY||window.ReactNativeWebView||et({allowedOrigins:h,url:r.origin}))))return;if(!(0===(f=e.allowedDomains||[]).length?!(void 0!==location.ancestorOrigins&&location.ancestorOrigins.length>1):void 0===location.ancestorOrigins||!(location.ancestorOrigins.length>0)||[...location.ancestorOrigins].every(e=>et({allowedOrigins:f,url:e}))))return eo(r,m.id,m.event,new l.D_("Frame ancestor is not allowed"));if("privy:iframe:ready"===m.event)return ed(r,m.id,m.event,{});if("privy:mfa:clear"===m.event){let t=m.data.userId.replace(/^did:privy:/,"");return F.A.del({appId:e.appId,userId:t}),ed(r,m.id,m.event,{})}let g=m.data.accessToken;if(!g)return eo(r,m.id,m.event,new l.D_("Missing auth token."));let T=await (0,ee.d)(g,i,e.appId);if(!T)return eo(r,m.id,m.event,new l.D_("Invalid auth token."));let{userId:P,appId:N}=T;try{let i=null!==(o=en[m.event])&&void 0!==o?o:"embedded_wallet_iframe_invalid_event",l=(t,a)=>(0,y.$1)({appId:N,appClientId:n,accessToken:g,clientId:e.clientAnalyticsId,eventName:t,payload:a});switch(en.hasOwnProperty(m.event)&&l("".concat(i,"_started"),{..."privy:wallet:create"===m.event&&m.data.recoveryMethod&&{recoveryMethod:m.data.recoveryMethod},..."privy:wallet:set-recovery-password"===m.event&&{existingRecoveryMethod:m.data.existingRecoveryMethod,targetRecoveryMethod:"user-passcode"},..."privy:wallet:set-recovery"===m.event&&{existingRecoveryMethod:m.data.existingRecoveryMethod,targetRecoveryMethod:m.data.recoveryMethod},..."privy:wallet:rpc"===m.event&&m.data.requesterAppId&&{requesterAppId:m.data.requesterAppId}}),m.event){case"privy:wallets:create":return eo(r,m.id,m.event,new A.Pi("error","Not implemented"));case"privy:wallets:add":{let{entropy:a,entropyType:i}=await (0,j.A)({...m.data,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,cache:t.current});if("private-key"===i)throw new A.Pi("hd_wallet_required","This action requires a hierarchical deterministic wallet. Imported wallets are not supported.");if("bitcoin-taproot"===m.data.chainType||"bitcoin-segwit"===m.data.chainType){let{address:e}=await I({...m.data,appId:N,appClientId:n,entropy:a,chainType:m.data.chainType});return ed(r,m.id,m.event,{address:e,hdWalletIndex:m.data.hdWalletIndex})}if("ethereum"===m.data.chainType){let{address:e}=await (0,s.h6)({...m.data,appId:N,appClientId:n,entropy:a});return ed(r,m.id,m.event,{address:e,hdWalletIndex:m.data.hdWalletIndex})}if("solana"===m.data.chainType){let{address:e}=await E({...m.data,appId:N,appClientId:n,entropy:a});return ed(r,m.id,m.event,{address:e,hdWalletIndex:m.data.hdWalletIndex})}return w(m.data.chainType,new A.Pi("invalid_request_arguments","Unknown chain type"))}case"privy:wallets:connect":return await G({appId:N,userId:P,address:m.data.entropyId}),ed(r,m.id,m.event,{entropyId:m.data.entropyId});case"privy:wallets:set-recovery":{let{entropy:a,entropyType:d}=await (0,j.A)({cache:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.entropyId,entropyIdVerifier:m.data.entropyIdVerifier,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if("ethereum-address-verifier"!==m.data.entropyIdVerifier&&"solana-address-verifier"!==m.data.entropyIdVerifier)throw new A.Pi("invalid_request_arguments","Unexpected entropy ID type: ".concat(m.data.entropyIdVerifier));if("private-key"===d)throw new A.Pi("hd_wallet_required","This action requires a hierarchical deterministic wallet. Imported wallets are not supported.");let o=await (0,s._U)({appId:N,appClientId:n,userId:P,accessToken:g,entropy:a,entropyId:m.data.entropyId,entropyIdVerifier:m.data.entropyIdVerifier,clientType:er(window),recoveryOptions:m.data,createWalletEvent:l});return l("".concat(i,"_completed"),{address:o.entropyId,existingRecoveryMethod:m.data.existingRecoveryMethod,targetRecoveryMethod:m.data.recoveryMethod}),ed(r,m.id,m.event,{entropyId:o.entropyId,entropyIdVerifier:m.data.entropyIdVerifier,recoveryMethod:m.data.recoveryMethod})}case"privy:wallets:recover":{let t=await (0,s.uP)({...m.data,appId:N,appClientId:n,userId:P,clientAnalyticsId:e.clientAnalyticsId,clientType:er(window)});return a(N,P,t),l("".concat(i,"_completed"),{entropyId:t.entropyId}),ed(r,m.id,m.event,{entropyId:t.entropyId})}case"privy:wallets:rpc":{let d=await (0,s.JG)({...m.data,appId:N,userId:P,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,cachedWalletData:t.current}),o=await W(d,m.data);return a(N,P,d),l("".concat(i,"_completed"),{address:d.wallet.address,method:o.method,...m.data.requesterAppId&&{requesterAppId:m.data.requesterAppId}}),ed(r,m.id,m.event,{address:d.wallet.address,response:o})}case"privy:wallet:create":{let a;m.data.solanaAddress&&(a=(await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.solanaAddress,entropyIdVerifier:"solana-address-verifier",chainType:"solana",hdWalletIndex:0,accessToken:g,mfaCode:null,mfaMethod:null,relyingParty:""})).entropy);let{wallet:d}=await (0,s.io)({appId:N,appClientId:n,userId:P,accessToken:g,existingEntropy:a,clientType:er(window),createWalletEvent:l,recoveryPassword:m.data.recoveryPassword,recoveryMethod:m.data.recoveryMethod,recoveryAccessToken:m.data.recoveryAccessToken,recoveryPin:m.data.recoveryPin,recoverySecretOverride:m.data.recoverySecretOverride,iCloudRecordNameOverride:m.data.iCloudRecordNameOverride});return l("".concat(i,"_completed"),{address:d.address}),ed(r,m.id,m.event,{address:d.address})}case"privy:wallet:create-additional":let u=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.primaryWalletAddress,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:null,mfaMethod:null,relyingParty:""});$(u);let{entropy:v}=u,h=await (0,s.h6)({...m.data,appId:N,appClientId:n,entropy:v});return l("".concat(i,"_completed"),{address:h.address}),ed(r,m.id,m.event,{address:h.address});case"privy:wallet:import":case"privy:wallets:import":{let{wallet:e}=await Y({appId:N,appClientId:n,userId:P,accessToken:g,privateKey:m.data.privateKey,chainType:"chainType"in m.data?m.data.chainType:"ethereum"});return l("".concat(i,"_completed"),{address:e.address}),ed(r,m.id,m.event,{address:e.address})}case"privy:wallet:set-recovery-password":case"privy:wallet:set-recovery":{let a=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if("ethereum"!==a.chainType)throw new A.Pi("error","Expected Ethereum wallet data");let d="privy:wallet:set-recovery"===m.event?m.data:{...m.data,recoveryMethod:"user-passcode"};$(a);let o=await (0,s._U)({appId:N,appClientId:n,userId:P,accessToken:g,entropy:a.entropy,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",clientType:er(window),recoveryOptions:d,createWalletEvent:l});return l("".concat(i,"_completed"),{address:o.entropyId,existingRecoveryMethod:d.existingRecoveryMethod,targetRecoveryMethod:d.recoveryMethod}),ed(r,m.id,m.event,{address:o.entropyId})}case"privy:wallet:connect":return await G({appId:N,userId:P,address:m.data.address}),ed(r,m.id,m.event,{address:m.data.address});case"privy:wallet:recover":let f=await (0,s.uP)({appId:N,clientAnalyticsId:e.clientAnalyticsId,appClientId:n,userId:P,accessToken:g,clientType:er(window),entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",recoveryPassword:m.data.recoveryPassword||m.data.recoveryPin,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty,recoveryAccessToken:m.data.recoveryAccessToken,recoverySecretOverride:m.data.recoverySecretOverride});return a(N,P,f),l("".concat(i,"_completed"),{address:f.wallet.address}),ed(r,m.id,m.event,{address:f.wallet.address});case"privy:wallet:rpc":{let d=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:null!==(c=m.data.hdWalletIndex)&&void 0!==c?c:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if(a(N,P,d),"ethereum"!==d.chainType)throw new A.Pi("error","Expected Ethereum wallet data");let o=await (0,s.jt)(d,m.data.request);return l("".concat(i,"_completed"),{address:d.wallet.address,method:o.method,...m.data.requesterAppId&&{requesterAppId:m.data.requesterAppId}}),ed(r,m.id,m.event,{address:m.data.address,response:o})}case"privy:solana-wallet:create":{let a;if(m.data.ethereumAddress){let r=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.ethereumAddress,entropyIdVerifier:"ethereum-address-verifier",chainType:"solana",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});$(r),a=r.entropy}let{wallet:d}=await (0,s.kL)({appId:N,appClientId:n,userId:P,accessToken:g,existingEntropy:a});return l("".concat(i,"_completed"),{publicKey:d.address}),ed(r,m.id,m.event,{publicKey:d.address})}case"privy:solana-wallet:create-additional":{let a=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,userId:P,entropyId:m.data.primaryPublicKey,entropyIdVerifier:"solana-address-verifier",chainType:"solana",clientAnalyticsId:e.clientAnalyticsId,hdWalletIndex:0,accessToken:g,mfaCode:null,mfaMethod:null,relyingParty:""}),{address:d}=await E({appId:N,appClientId:n,accessToken:g,hdWalletIndex:m.data.hdWalletIndex,entropy:a.entropy});return l("".concat(i,"_completed"),{address:d}),ed(r,m.id,m.event,{publicKey:d})}case"privy:solana-wallet:connect":return await G({appId:N,userId:P,address:m.data.publicKey}),ed(r,m.id,m.event,{publicKey:m.data.publicKey});case"privy:solana-wallet:recover":let T=await (0,s.uP)({appId:N,appClientId:n,userId:P,accessToken:g,entropyId:m.data.publicKey,entropyIdVerifier:"solana-address-verifier",mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty,clientAnalyticsId:e.clientAnalyticsId,clientType:er(window),recoveryAccessToken:m.data.recoveryAccessToken,recoverySecretOverride:m.data.recoverySecretOverride,recoveryPassword:m.data.recoveryPassword});return a(N,P,T),l("".concat(i,"_completed"),{publicKey:m.data.publicKey}),ed(r,m.id,m.event,{publicKey:m.data.publicKey});case"privy:solana-wallet:rpc":let D=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.publicKey,entropyIdVerifier:"solana-address-verifier",chainType:"solana",hdWalletIndex:null!==(p=m.data.hdWalletIndex)&&void 0!==p?p:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});if(a(N,P,D),"solana"!==D.chainType)throw new A.Pi("error","Expected Ethereum wallet data");let O=await (0,s.Zv)(D.wallet.keypair,m.data);return l("".concat(i,"_completed"),{method:O.method,publicKey:m.data.publicKey}),ed(r,m.id,m.event,{publicKey:m.data.publicKey,response:O});case"privy:delegated-actions:consent":{let a;if("ethereum"===m.data.rootWallet.chainType){let r=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.rootWallet.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});$(r),a=r.entropy}else if("solana"===m.data.rootWallet.chainType){let r=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.rootWallet.address,entropyIdVerifier:"solana-address-verifier",chainType:"solana",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});$(r),a=r.entropy}else throw new A.Pi("invalid_request_arguments","Unexpected chain type for root delegation wallet");return await b({entropy:a,delegatedWallets:m.data.delegatedWallets,appId:N,appClientId:n,accessToken:g}),ed(r,m.id,m.event,{success:!0})}case"privy:mfa:verify":return await J({appId:N,appClientId:n,userId:P,...m.data}),ed(r,m.id,m.event,{});case"privy:mfa:init-enrollment":{let e=await H({appId:N,appClientId:n,userId:P,...m.data});return ed(r,m.id,m.event,{method:m.data.method,secret:e.totpSecret,authUrl:e.totpAuthUrl})}case"privy:mfa:submit-enrollment":return await X({appId:N,appClientId:n,userId:P,...m.data}),ed(r,m.id,m.event,{});case"privy:mfa:unenroll":return await Q({appId:N,appClientId:n,userId:P,...m.data}),ed(r,m.id,m.event,{});case"privy:farcaster:init-signer":{let d=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:null!==(_=m.data.hdWalletIndex)&&void 0!==_?_:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});a(N,P,d),$(d);let{entropy:o}=d,c=await C({appId:N,appClientId:n,entropy:o,accessToken:m.data.accessToken});return l("".concat(i,"_completed"),{address:d.wallet.address}),ed(r,m.id,m.event,c)}case"privy:farcaster:sign":{let o=await (0,s.JG)({cachedWalletData:t.current,appId:N,appClientId:n,clientAnalyticsId:e.clientAnalyticsId,userId:P,entropyId:m.data.address,entropyIdVerifier:"ethereum-address-verifier",chainType:"ethereum",hdWalletIndex:0,accessToken:g,mfaCode:m.data.mfaCode,mfaMethod:m.data.mfaMethod,relyingParty:m.data.relyingParty});a(N,P,o);let c=d._d.toBuffer(m.data.payload.hash);$(o);let{entropy:p}=o,{privateKey:y}=await S(p),_=function(e){let{farcasterSignerPrivateKey:t,hash:a}=e;if(20!==a.length){let e=M.from(a).toString("utf-8");try{K.parse(e)}catch(e){throw Error("Invalid blake3 hash length. Expected 20 bytes.")}}return x.ev.sign(a,t)}({farcasterSignerPrivateKey:y,hash:c});return l("".concat(i,"_completed"),{address:o.wallet.address}),ed(r,m.id,m.event,{hash:m.data.payload.hash,signature:d._d.fromBuffer(_)})}}}catch(e){if((0,A.$J)(e))return P&&F.A.del({appId:N,userId:P}),eo(r,m.id,m.event,new A.Pi("missing_or_invalid_mfa","MFA verification failed"));if(function(e){var t,a;let r=null===(t=e.data)||void 0===t?void 0:t.code,n=[l.si.INVALID_DATA,l.si.NOT_SUPPORTED,l.si.INVALID_DATA,l.si.NOT_SUPPORTED,l.si.USER_UNSUBSCRIBED].includes(r);return(null===(a=e.response)||void 0===a?void 0:a.status)===422&&n}(e))return P&&F.A.del({appId:N,userId:P}),eo(r,m.id,m.event,new A.Pi("twilio_verification_failed",null!==(v=null===(u=e.data)||void 0===u?void 0:u.error)&&void 0!==v?v:"MFA enrollment failed"));eo(r,m.id,m.event,e);return}}return ea(window)?document.addEventListener("message",o):window.addEventListener("message",o),()=>{ea(window)?document.removeEventListener("message",o):window.removeEventListener("message",o)}},[e.allowedDomains,e.appId,e.appClientId]),null}var es=!0;function ec(e){let{appId:t,appClientId:a,clientAnalyticsId:n,allowedDomains:d,apiUrl:o}=e;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i(),{children:(0,r.jsx)("title",{children:"Wallet \xb7 Privy"})}),(0,r.jsx)(el,{appId:t,appClientId:a,clientAnalyticsId:n,allowedDomains:d,apiUrl:o})]})}},78871:(e,t,a)=>{"use strict";t.Lv=function(e,t){let a=(0,i.encrypt)(e,d.encode(t)),n={cipherText:o(a.cipherText),ephemeralPublicKey:o(a.ephemeralPublicKey),nonce:o(a.nonce),version:1};return r.base64.encode(d.encode(JSON.stringify(n)))};let r=a(56710),n=a(75995),i=a(90846);a(90846),new TextDecoder;let d=new TextEncoder;function o(e){return btoa(String.fromCharCode(...e))}n.z.object({cipherText:n.z.string(),ephemeralPublicKey:n.z.string(),nonce:n.z.string(),version:n.z.literal(1)}).required()},90846:function(e,t,a){"use strict";var r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.generateKeyPair=d,t.encrypt=function(e,t){let a=d(),r=n.default.randomBytes(n.default.box.nonceLength);return{cipherText:n.default.box(t,r,e,a.privateKey),ephemeralPublicKey:a.publicKey,nonce:r}},t.decrypt=function(e,t){let a=n.default.box.open(t.cipherText,t.nonce,t.ephemeralPublicKey,e);if(null===a)throw new i.DecryptionError("Decryption failed");return a};let n=r(a(82926)),i=a(84483);function d(){let e=n.default.box.keyPair();return{publicKey:e.publicKey,privateKey:e.secretKey}}},84483:(e,t)=>{"use strict";function a(e){return class extends Error{constructor(t){super(t),this.name=e}}}Object.defineProperty(t,"__esModule",{value:!0}),t.EncryptionKeyError=t.EncryptionSizeError=t.DecryptionError=void 0,t.DecryptionError=a("DecryptionError"),t.EncryptionSizeError=a("EncryptionSizeError"),t.EncryptionKeyError=a("EncryptionKeyError")},93454:(e,t,a)=>{"use strict";a.d(t,{D_:()=>o,ZT:()=>l,oC:()=>d,si:()=>n});var r=a(46195),n=(e=>(e.OAUTH_ACCOUNT_SUSPENDED="oauth_account_suspended",e.MISSING_OR_INVALID_PRIVY_APP_ID="missing_or_invalid_privy_app_id",e.MISSING_OR_INVALID_PRIVY_CLIENT_ID="missing_or_invalid_privy_client_id",e.MISSING_OR_INVALID_PRIVY_ACCOUNT_ID="missing_or_invalid_privy_account_id",e.MISSING_OR_INVALID_TOKEN="missing_or_invalid_token",e.MISSING_OR_INVALID_MFA="missing_or_invalid_mfa",e.EXPIRED_OR_INVALID_MFA_TOKEN="expired_or_invalid_mfa_token",e.INVALID_DATA="invalid_data",e.INVALID_CREDENTIALS="invalid_credentials",e.INVALID_CAPTCHA="invalid_captcha",e.LINKED_TO_ANOTHER_USER="linked_to_another_user",e.ALLOWLIST_REJECTED="allowlist_rejected",e.CANNOT_UNLINK_EMBEDDED_WALLET="cannot_unlink_embedded_wallet",e.CANNOT_UNLINK_SOLE_ACCOUNT="cannot_unlink_sole_account",e.CANNOT_LINK_MORE_OF_TYPE="cannot_link_more_of_type",e.LINKED_ACCOUNT_NOT_FOUND="linked_account_not_found",e.TOO_MANY_REQUESTS="too_many_requests",e.INVALID_ORIGIN="invalid_origin",e.MISSING_ORIGIN="missing_origin",e.INVALID_NATIVE_APP_ID="invalid_native_app_id",e.TOKEN_ALREADY_USED="token_already_used",e.ALREADY_LOGGED_OUT="already_logged_out",e.NOT_SUPPORTED="not_supported",e.USER_UNSUBSCRIBED="user_unsubscribed",e.MAX_APPS_REACHED="max_apps_reached",e.USER_LIMIT_REACHED="max_accounts_reached",e.DEVICE_REVOKED="device_revoked",e.WALLET_PASSWORD_EXISTS="wallet_password_exists",e.OAUTH_STATE_MISMATCH="oauth_state_mismatch",e.MAX_DENYLIST_ENTRIES_REACHED="max_denylist_entries_reached",e.DISALLOWED_LOGIN_METHOD="disallowed_login_method",e.DISALLOWED_PLUS_EMAIL="disallowed_plus_email",e.DISALLOWED_RECOVERY_METHOD="disallowed_recovery_method",e.LEGACY_DASHBOARD_LOGIN_CONFIGURATION="legacy_dashboard_login_configuration",e.CANNOT_SET_PASSWORD="cannot_set_password",e.INVALID_PKCE_PARAMETERS="invalid_pkce_parameters",e.INVALID_APP_URL_SCHEME_CONFIGURATION="invalid_app_url_scheme_configuration",e.CROSS_APP_CONNECTION_NOT_ALLOWED="cross_app_connection_not_allowed",e.USER_DOES_NOT_EXIST="user_does_not_exist",e.ACCOUNT_TRANSFER_REQUIRED="account_transfer_required",e.USER_HAS_NOT_DELEGATED_WALLET="user_has_not_delegated_wallet",e.FEATURE_NOT_ENABLED="feature_not_enabled",e.INSUFFICIENT_FUNDS="insufficient_funds",e.TRANSACTION_BROADCAST_FAILURE="transaction_broadcast_failure",e))(n||{}),i=class extends Error{status;code;responseData;constructor(e,t,a,r){super(t),this.code=a,this.status=e,this.responseData=r}toString(){return`${this.constructor.name}: ${this.message}${this.cause?` [cause: ${this.cause}]`:""}`}},d=class extends i{constructor(e,t){super(400,e,t||"invalid_data")}},o=class extends i{constructor(e,t){super(401,e,t)}},l=class extends i{constructor(e,t){super(422,e,t)}};r.z.object({error:r.z.string(),cause:r.z.string().optional(),code:r.z.nativeEnum(n).optional()})}},e=>{var t=t=>e(e.s=t);e.O(0,[2968,8610,6195,1963,2406,7338,1307,807,3138,5398,636,6593,8792],()=>t(11723)),_N_E=e.O()}]);